(function (ipmsRoot) {
    var AutomatedResourceScheduleModel = function (data) {

    }

    var Slot = function (data) {

        var self = this;

        self.SlotNumber = ko.observable(data ? data.SlotNumber : "");
        self.SlotPeriod = ko.observable(data ? data.SlotPeriod : "");
        self.AllocationDate = ko.observable(data ? data.AllocationDate : "");
        self.SlotHeader = ko.observable(data ? data.SlotHeader : "");
        self.ShiftID = ko.observable(data ? data.ShiftID : "");
        self.Duration = ko.observable(data ? data.Duration : "");
        self.StartMinutes = ko.observable(data ? data.StartMinutes : "");
        self.EndMinutes = ko.observable(data ? data.EndMinutes : "");
    }

    var ConfirmedServiceRequestsModel = function (data) {
        var self = this;

        self.VesselName = ko.observable(data ? data.VesselName : "");
        self.VCN = ko.observable(data ? data.VCN : "");
        self.ServiceRequestID = ko.observable(data ? data.ServiceRequestID : "");
        self.ServiceRequest = ko.observable(data ? data.ServiceRequest : "");
        self.LengthOverAll = ko.observable(data ? data.LengthOverAll : "");
        self.GrossRegisteredTonnage = ko.observable(data ? data.GrossRegisteredTonnage : "");
        self.ReasonForVisit = ko.observable(data ? data.ReasonForVisit : "");
        self.ETUB = ko.observable(data ? (data.ETUB == null ? "NA" : moment(data.ETUB).format('YYYY-MM-DD HH:mm')) : "NA");
        self.ETB = ko.observable(data ? (data.ETB == null ? "NA" : moment(data.ETB).format('YYYY-MM-DD HH:mm')) : "NA");
        self.CargoType = ko.observable(data ? (data.CargoType == null ? "NA" : data.CargoType) : "");
        self.Quantity = ko.observable(data ? (data.Quantity == 0 ? "NA" : data.Quantity) : "NA");

        self.Slot = ko.observable(data ? data.Slot : "");
        self.SlotDate = ko.observable(data ? data.SlotDate : "");
        self.SlotStatus = ko.observable(data ? data.SlotStatus : "");
        self.MovementType = ko.observable(data ? data.MovementType : "");
        self.AnyDangerousGoodsonBoard = ko.observable(data ? data.AnyDangerousGoodsonBoard : "I");
        self.TidalCondition = ko.observable(data ? (data.TidalCondition == "I" ? "No" : "Yes") : "N0");
        self.DayLightCondition = ko.observable(data ? (data.DayLightCondition == "I" ? "No" : "Yes") : "No");
        self.CurrentBerth = ko.observable(data ? (data.CurrentBerth + " to " + data.ToBerth) : "");
        self.ToBerth = ko.observable(data ? data.ToBerth : "");
        self.SideAlongSide = ko.observable(data ? data.SideAlongSide : "");

        //var txt = "<table  style='border:0px solid #f00; line-height:25px; ' width='100%'><tr ><td  style='text-align:right'><b>VCN</b></td><td width=5px;>:</td><td style='text-align:left'>" + self.VCN() + " </td></tr>  <tr><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td></tr> <tr><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td></tr> <tr><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GrossRegisteredTonnage() + " </td></tr> <tr><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LengthOverAll() + " </td></tr> <tr><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left'>" + self.ReasonForVisit() + " </td></tr> <tr><td  style='text-align:right'><b>ETB</b></td><td>:</td><td style='text-align:left'>" + self.ETB() + " </td></tr></tr> <tr><td  style='text-align:right'><b>ETUB</b></td><td>:</td><td style='text-align:left'>" + self.ETUB() + " </td></tr> <tr><td  style='text-align:right'><b>Planned Slot</b></td><td>:</td><td style='text-align:left'>" + self.Slot() + " </td></tr></table> ";
        //var txt = "<table  style='border:0px solid #f00; line-height:25px; '> <tr ><td  style='text-align:right' valign='top'><b>VCN</b></td><td width=5 valign='top'>:</td><td style='text-align:left' valign='top'>" + self.VCN() + "</td><td  style='text-align:right' valign='top'><b>Movement Type</b></td><td width=5 valign='top'>:</td><td style='text-align:left' valign='top'>" + self.MovementType() + " </td><td  style='text-align:right' valign='top'><b>Planned Slot</b></td><td td width=5 valign='top'>:</td><td style='text-align:left' valign='top'>" + self.Slot() + " </td></tr>  <tr><td  style='text-align:right' valign='top' ><b>Vessel Name</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.VesselName() + " </td><td  style='text-align:right' valign='top'><b>ETB</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.ETB() + " </td><td  style='text-align:right' valign='top'><b>ETUB</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.ETUB() + " </td></tr>   <tr><td  style='text-align:right' valign='top'><b>Reason For Visit</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.ReasonForVisit() + " </td><td  style='text-align:right' valign='top'><b>Side Along Side</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.SideAlongSide() + " </td><td  style='text-align:right' valign='top'><b>GRT</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.GrossRegisteredTonnage() + " </td></tr>    <tr><td  style='text-align:right' valign='top'><b>LOA</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.LengthOverAll() + " </td><td  style='text-align:right' valign='top'><b>Tidal Condition</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.TidalCondition() + " </td><td  style='text-align:right' valign='top'><b>Daylight Condition</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.DayLightCondition() + " </td></tr>    <tr><td  style='text-align:right;' valign='top'><b>Current Berth</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.CurrentBerth() + " </td><td  style='text-align:right' valign='top'><b>To Berth</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.ToBerth() + "</td><td style='text-align:left' valign='top'>&nbsp;</td><td style='text-align:left' valign='top'>&nbsp;</td><td style='text-align:left' valign='top'>&nbsp;</td></tr></table>";
        var text;

        if (self.MovementType() == "Arrival") {
            txt = "<table  style='border:0px solid #f00; line-height:25px;'> <tr><td  style='text-align:right' valign='top'><b>VCN</b></td><td width=5 valign='top'>:</td><td style='text-align:left' valign='top'>" + self.VCN() + "</td><td  style='text-align:right' valign='top'><b>Movement Type</b></td><td width=5 valign='top'>:</td><td style='text-align:left' valign='top'>" + self.MovementType() + " </td><td  style='text-align:right' valign='top'><b>Planned Slot</b></td><td td width=5 valign='top'>:</td><td style='text-align:left' valign='top'>" + self.Slot() + " </td></tr> <tr><td  style='text-align:right' valign='top' ><b>Vessel Name</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.VesselName() + " </td><td  style='text-align:right' valign='top'><b>ETB</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.ETB() + " </td><td  style='text-align:right' valign='top'><b>ETUB</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.ETUB() + " </td></tr> <tr><td  style='text-align:right' valign='top'><b>Reason For Visit</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.ReasonForVisit() + " </td><td  style='text-align:right' valign='top'><b>Side Along Side</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.SideAlongSide() + " </td><td  style='text-align:right' valign='top'><b>GRT</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.GrossRegisteredTonnage() + " </td></tr> <tr><td  style='text-align:right' valign='top'><b>LOA</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.LengthOverAll() + " </td><td  style='text-align:right' valign='top'><b>Tidal Condition</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.TidalCondition() + " </td><td  style='text-align:right' valign='top'><b>Daylight Condition</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.DayLightCondition() + " </td></tr> <tr><td  style='text-align:right' valign='top'><b>To Berth</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.ToBerth() + "</td><td style='text-align:right' valign='top'>&nbsp;</td><td valign='top'>&nbsp;</td><td style='text-align:left' valign='top'>&nbsp;</td><td style='text-align:right' valign='top'>&nbsp;</td><td valign='top'>&nbsp;</td><td style='text-align:left' valign='top'>&nbsp;</td></tr> </table>";
        }
        else{
            txt = "<table  style='border:0px solid #f00; line-height:25px; '> <tr ><td  style='text-align:right' valign='top'><b>VCN</b></td><td width=5 valign='top'>:</td><td style='text-align:left' valign='top'>" + self.VCN() + "</td><td  style='text-align:right' valign='top'><b>Movement Type</b></td><td width=5 valign='top'>:</td><td style='text-align:left' valign='top'>" + self.MovementType() + " </td><td  style='text-align:right' valign='top'><b>Planned Slot</b></td><td td width=5 valign='top'>:</td><td style='text-align:left' valign='top'>" + self.Slot() + " </td></tr>  <tr><td  style='text-align:right' valign='top' ><b>Vessel Name</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.VesselName() + " </td><td  style='text-align:right' valign='top'><b>ETB</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.ETB() + " </td><td  style='text-align:right' valign='top'><b>ETUB</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.ETUB() + " </td></tr>   <tr><td  style='text-align:right' valign='top'><b>Reason For Visit</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.ReasonForVisit() + " </td><td  style='text-align:right' valign='top'><b>Side Along Side</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.SideAlongSide() + " </td><td  style='text-align:right' valign='top'><b>GRT</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.GrossRegisteredTonnage() + " </td></tr>    <tr><td  style='text-align:right' valign='top'><b>LOA</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.LengthOverAll() + " </td><td  style='text-align:right' valign='top'><b>Tidal Condition</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.TidalCondition() + " </td><td  style='text-align:right' valign='top'><b>Daylight Condition</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.DayLightCondition() + " </td></tr>    <tr><td  style='text-align:right;' valign='top'><b>Current Berth</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.CurrentBerth() + " </td><td  style='text-align:right' valign='top'><b>To Berth</b></td><td valign='top'>:</td><td style='text-align:left' valign='top'>" + self.ToBerth() + "</td><td style='text-align:right' valign='top'>&nbsp;</td><td valign='top'>&nbsp;</td><td style='text-align:left' valign='top'>&nbsp;</td></tr></table>";
        }

        self.ToolTip = ko.observable(txt)

        self.VesselNameSort;
        self.VesselName.subscribe(function (value) {
            self.VesselNameSort = value;
        });
        self.VCNSort;
        self.VCN.subscribe(function (value) {
            self.VCNSort = value;
        });
        self.ServiceRequestSort;
        self.ServiceRequest.subscribe(function (value) {
            self.ServiceRequestSort = value;
        });
        self.ServiceRequestIDSort;
        self.ServiceRequestID.subscribe(function (value) {
            self.ServiceRequestIDSort = value;
        });
        self.LengthOverAllSort;
        self.LengthOverAll.subscribe(function (value) {
            self.LengthOverAllSort = value;
        });
        self.GrossRegisteredTonnageSort;
        self.GrossRegisteredTonnage.subscribe(function (value) {
            self.GrossRegisteredTonnageSort = value;
        });
        self.MovementTypeSort;
        self.MovementType.subscribe(function (value) {
            self.MovementTypeSort = value;
        });
    }

    var Users = function (data) {
        var self = this;

        self.ID = ko.observable(data ? data.ID : "");
        self.Name = ko.observable(data ? data.Name : "");
    }

    var ResourceAllocations = function (data) {
        var self = this;

        self.ServiceRequestId = ko.observable(data ? data.ServiceRequestId : "");
        self.Slot = ko.observable(data ? data.Slot : "");
        self.SlotDate = ko.observable(data ? data.SlotDate : "");
        self.VCN = ko.observable(data ? data.VCN : "");
        self.VesselName = ko.observable(data ? data.VesselName : "");
        self.ServiceType = ko.observable(data ? data.ServiceType : "");
        self.MovementType = ko.observable(data ? data.MovementType : "");
        self.AnyDangerousGoodsonBoard = ko.observable(data ? data.AnyDangerousGoodsonBoard : "I");
        self.VesselType = ko.observable(data ? data.VesselType : "");
        self.ETA = ko.observable(data ? data.ETA : "");
        self.ReasonForVisit = ko.observable(data ? data.ReasonForVisit : "");
        self.CargoType = ko.observable(data ? data.CargoType : "");
        self.LOA = ko.observable(data ? data.LOA : 0);
        self.GRT = ko.observable(data ? data.GRT : 0);
        self.DWT = ko.observable(data ? data.DWT : 0);
        self.CurrentBerth = ko.observable(data ? data.CurrentBerth + " to " + data.ToBerth : "NA");
        self.ToBerth = ko.observable(data ? data.ToBerth : "NA");
        self.MovementDateTime = ko.observable(data ? data.MovementDateTime : "");
        self.Beam = ko.observable(data ? data.Beam : 0);
        self.ArrivalDraft = ko.observable(data ? data.ArrivalDraft : 0);
        self.TidalCondition = ko.observable(data ? data.TidalCondition == "I" ? "NO" : "YES" : "NO");
        self.DayLightCondition = ko.observable(data ? data.DayLightCondition == "I" ? "NO" : "YES" : "NO");
        self.FromBollard = ko.observable(data ? data.FromBollard : "NA");
        self.ToBollard = ko.observable(data ? data.ToBollard : "NA");
        self.MovementTypeCode = ko.observable(data ? data.MovementTypeCode : "NA");
        self.MovementStatus = ko.observable(data ? data.MovementStatus : "");
        self.SideAlongSide = ko.observable(data ? data.SideAlongSide : "NA");

        self.ResourceAllocationSlots = ko.observableArray(data ? ko.utils.arrayMap(data.ResourceAllocationSlots, function (item) {
            return new ResourceAllocationSlots(item);
        }) : []);

        //self.Titel = "<table> <tr><td style='text-align:center'>" + self.VCN() + " </td></tr> <tr><td style='text-align:center'>" + self.VesselName() + " </td></tr> <tr><td style='text-align:center'>" + self.MovementType() + " </td></tr> </table>";

        // self.Titel = self.VCN() + ' - ' + self.VesselName() + ' - ' + self.MovementType();
        //var movementResourceAllocationsStructure = "<table width='100%'  style='border:0px solid #f00; line-height:25px; '><tr><td style='text-align:right'><b>VCN</b></td><td width=5px;>:</td><td style='text-align:left'>" + self.VCN() + " </td></tr><tr><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td  style='text-align:left'>" + self.VesselName() + " </td></tr> <tr><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td  style='text-align:left'>" + self.MovementType() + " </td></tr>  </table> ";
        var movementResourceAllocationsStructure;// = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + "</td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>To Berth</b></td><td>:</td><td style='text-align:left'>" + self.ToBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";

        if (self.MovementTypeCode() == "ARMV") {
            //Arrival            
            if (self.AnyDangerousGoodsonBoard() == "A") {
                //movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left;background-color:#FA370E'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + "</td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>To Berth</b></td><td>:</td><td style='text-align:left'>" + self.ToBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
                //movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left;background-color:#FA370E'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td  style='text-align:right'><b>Side Along Side</b></td><td>:</td><td style='text-align:left'>" + self.SideAlongSide() + " </td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + "</td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>To Berth</b></td><td>:</td><td style='text-align:left'>" + self.ToBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr></table>";
                movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left;background-color:#FA370E'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td  style='text-align:right'><b>Side Along Side</b></td><td>:</td><td style='text-align:left'>" + self.SideAlongSide() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>To Berth</b></td><td>:</td><td style='text-align:left'>" + self.ToBerth() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table>";
            }
            else {
                //movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + "</td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>To Berth</b></td><td>:</td><td style='text-align:left'>" + self.ToBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
                //movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td  style='text-align:right'><b>Side Along Side</b></td><td>:</td><td style='text-align:left'>" + self.SideAlongSide() + " </td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + "</td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>To Berth</b></td><td>:</td><td style='text-align:left'>" + self.ToBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table>";
                movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td  style='text-align:right'><b>Side Along Side</b></td><td>:</td><td style='text-align:left'>" + self.SideAlongSide() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>To Berth</b></td><td>:</td><td style='text-align:left'>" + self.ToBerth() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table>";
            }
        }
        if (self.MovementTypeCode() == "SGMV") {
            //Sailing
            if (self.AnyDangerousGoodsonBoard() == "A") {
                //movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left;background-color:#FA370E'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + " </td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border-bottom:2px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
                movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left;background-color:#FA370E'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td  style='text-align:right'><b>Side Along Side</b></td><td>:</td><td style='text-align:left'>" + self.SideAlongSide() + " </td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + " </td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border-bottom:2px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table>";
            }
            else {
                //movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + " </td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border-bottom:2px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
                movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td  style='text-align:right'><b>Side Along Side</b></td><td>:</td><td style='text-align:left'>" + self.SideAlongSide() + " </td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + " </td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border-bottom:2px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
            }
        }
        if (self.MovementTypeCode() == "SHMV") {
            //Shifting
            if (self.AnyDangerousGoodsonBoard() == "A") {
                //movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left;background-color:#FA370E'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + " </td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>To Berth</b></td><td>:</td><td style='text-align:left'>" + self.ToBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
                movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left;background-color:#FA370E'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td  style='text-align:right'><b>Side Along Side</b></td><td>:</td><td style='text-align:left'>" + self.SideAlongSide() + " </td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + " </td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>To Berth</b></td><td>:</td><td style='text-align:left'>" + self.ToBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
            }
            else {
                //movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + " </td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>To Berth</b></td><td>:</td><td style='text-align:left'>" + self.ToBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
                movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td  style='text-align:right'><b>Side Along Side</b></td><td>:</td><td style='text-align:left'>" + self.SideAlongSide() + " </td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + " </td><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>To Berth</b></td><td>:</td><td style='text-align:left'>" + self.ToBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
            }
        }
        if (self.MovementTypeCode() == "WRMV") {
            //Warping
            if (self.AnyDangerousGoodsonBoard() == "A") {
                //movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left;background-color:#FA370E'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
                movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left;background-color:#FA370E'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td  style='text-align:right'><b>Side Along Side</b></td><td>:</td><td style='text-align:left'>" + self.SideAlongSide() + " </td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
            }
            else {
                //movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
                movementResourceAllocationsStructure = "<table style='border:0px solid #f00; line-height:30px;'> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>VCN</b></td><td>:</td><td style='text-align:left'>" + self.VCN() + " </td><td  style='text-align:right'><b>Vessel Name</b></td><td>:</td><td style='text-align:left'>" + self.VesselName() + " </td><td  style='text-align:right'><b>Vessel Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.VesselType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>ETA</b></td><td>:</td><td style='text-align:left'>" + moment(self.ETA()).format('YYYY-MM-DD HH:mm') + " </td><td  style='text-align:right'><b>Reason For Visit</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.ReasonForVisit() + " </td><td  style='text-align:right'><b>Cargo Type</b></td><td>:</td><td style='text-align:left;width:200px; line-height:17px;'>" + self.CargoType() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>LOA</b></td><td>:</td><td style='text-align:left'>" + self.LOA() + " </td><td  style='text-align:right'><b>Beam</b></td><td>:</td><td style='text-align:left'>" + self.Beam() + " </td><td  style='text-align:right'><b>Arrival Draft</b></td><td>:</td><td style='text-align:left'>" + self.ArrivalDraft() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>GRT</b></td><td>:</td><td style='text-align:left'>" + self.GRT() + " </td><td  style='text-align:right'><b>DWT</b></td><td>:</td><td style='text-align:left'>" + self.DWT() + " </td><td  style='text-align:right'><b>Side Along Side</b></td><td>:</td><td style='text-align:left'>" + self.SideAlongSide() + " </td></tr> <tr style='border-bottom:0px solid #ddd;'><td  style='text-align:right'><b>Tidal Condition</b></td><td>:</td><td style='text-align:left'>" + self.TidalCondition() + " </td><td  style='text-align:right'><b>Daylight Condition</b></td><td>:</td><td style='text-align:left'>" + self.DayLightCondition() + " </td></tr> <tr style='border:2px solid #f00;'><td  style='text-align:right'><b>Current Berth</b></td><td>:</td><td style='text-align:left'>" + self.CurrentBerth() + " </td><td  style='text-align:right'><b>Current Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.FromBollard() + " </td><td  style='text-align:right'><b>To Bollard No's</b></td><td>:</td><td style='text-align:left'>" + self.ToBollard() + " </td></tr> <tr style='border-bottom:1px solid #ddd;'><td  style='text-align:right'><b>Movement Type</b></td><td>:</td><td style='text-align:left'>" + self.MovementType() + " </td><td  style='text-align:right'><b>Movement Date and Time</b></td><td>:</td><td style='text-align:left'>" + moment(self.MovementDateTime()).format('YYYY-MM-DD HH:mm') + " </td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr> </table> ";
            }
        }

        self.movementResourceAllocationsDetails = ko.observable(movementResourceAllocationsStructure);

        self.IsConfirm = ko.observable(data ? data.IsConfirm : false);

        self.OperationType = ko.observable(data ? data.OperationType : "");
    }

    var ResourceAllocationSlots = function (data) {

        var self = this;

        self.AllocSlot = ko.observable(data ? data.AllocSlot : "");
        self.CraftID = ko.observable(data ? data.CraftID : "");
        self.CraftName = ko.observable(data ? data.CraftName : "");
        self.CreatedBy = ko.observable(data ? data.CreatedBy : "");
        self.CreatedDate = ko.observable(data ? data.CreatedDate : "");
        self.EndTime = ko.observable(data ? data.EndTime : "");
        self.ModifiedBy = ko.observable(data ? data.ModifiedBy : "");
        self.ModifiedDate = ko.observable(data ? data.ModifiedDate : "");
        self.RecordStatus = ko.observable(data ? data.RecordStatus : "");
        self.ResourceAllocationID = ko.observable(data ? data.ResourceAllocationID : "");
        self.ServiceReferenceID = ko.observable(data ? data.ServiceReferenceID : "");
        self.ServiceReferenceType = ko.observable(data ? data.ServiceReferenceType : "");
        self.ServiceTypeCode = ko.observable(data ? data.ServiceTypeCode : "");
        self.ServiceTypeName = ko.observable(data ? data.ServiceTypeName : "");
        self.StartTime = ko.observable(data ? data.StartTime : "");
        self.VCN = ko.observable(data ? data.VCN : "");
        self.VesselName = ko.observable(data ? data.VesselName : "");
        self.IsCraft = ko.observable(data ? data.IsCraft : false);
        self.ServiceTypeCode = ko.observable(data ? data.ServiceTypeCode : "");
        self.TaskStatus = ko.observable(data ? data.TaskStatus : "");
        self.Slots = ko.observableArray([]);
        self.count = ko.observable(data ? data.count : 0);
        self.IsChanged = ko.observable(data ? data.IsChanged : false);
        self.AddSlotNumber = ko.observable(data ? data.AddSlotNumber : 0);
        self.AllocationDate = ko.observable(data ? data.AllocationDate : "");
        for (var i = 1; i <= self.count() ; i++) {

            //if (i == 1) {
            if (i == self.AddSlotNumber()) {
                self.Slots.push(new ResourceSlot({ ResourceName: 'Unscheduled', TugResourceName: 'Unscheduled', IsCraft: self.IsCraft(), ServiceTypeCode: self.ServiceTypeCode(), ServiceTypeName: self.ServiceTypeName(), CraftId: 0, ResourceID: 0, TaskStatus: self.TaskStatus(), ServiceReferenceID: self.ServiceReferenceID(), SlotNumber: self.AddSlotNumber(), IsChanged: self.IsChanged(), AllocationDate: self.AllocationDate() }));
            }
            else {
                self.Slots.push(new ResourceSlot({ ResourceName: null, IsCraft: false, ResourceID: null }));
            }
        }

        self.ResourceSlots = ko.observableArray(data ? (data.ResourceSlots != undefined) ? ko.utils.arrayMap(data.ResourceSlots, function (item) {
            return new ResourceSlot(item);
        }) : self.Slots() : self.Slots());

        self.IsServiceTypeDeleted = ko.observable(data ? data.IsServiceTypeDeleted : false);
    }

    var ResourceSlot = function (data) {

        var self = this;
        self.IsCraft = ko.observable(data ? data.IsCraft : false);
        self.ResourceAllocationID = ko.observable(data ? data.ResourceAllocationID : "");
        self.ResourceID = ko.observable(data ? data.ResourceID : null);
        self.ResourceName = ko.observable(data ? data.ResourceName : "");
        self.ServiceReferenceID = ko.observable(data ? data.ServiceReferenceID : "");
        self.ServiceTypeCode = ko.observable(data ? data.ServiceTypeCode : "");
        self.ServiceTypeName = ko.observable(data ? data.ServiceTypeName : "");
        self.SlotNumber = ko.observable(data ? data.SlotNumber : "");
        self.Status = ko.observable(data ? data.Status : "");
        self.CraftID = ko.observable(data ? data.CraftID : "");
        self.CraftName = ko.observable(data ? data.CraftName : "");
        self.ShiftID = ko.observable(data ? data.ShiftID : "");
        self.SlotPeriod = ko.observable(data ? data.SlotPeriod : "");
        self.TugResourceName = ko.observable(data ? data.TugResourceName : "");
        self.TaskStatus = ko.observable(data ? data.TaskStatus : "");
        self.IsChanged = ko.observable(data ? data.IsChanged : false);
        self.AllocationDate = ko.observable(data ? data.AllocationDate : "");
    }

    var ResourceSlotVO = function (data) {

        var self = this;
        self.SlotNumber = ko.observable(data ? data.SlotNumber : "");
        self.ResourceName = ko.observable(data ? data.ResourceName : "");
        self.ResourceID = ko.observable(data ? data.ResourceID : null);
        self.ServiceTypeCode = ko.observable(data ? data.ServiceTypeCode : "");
        self.ServiceTypeName = ko.observable(data ? data.ServiceTypeName : "");
        self.Status = ko.observable(data ? data.Status : "");
        self.IsCraft = ko.observable(data ? data.IsCraft : "");
        self.ServiceReferenceID = ko.observable(data ? data.ServiceReferenceID : "");
        self.ResourceAllocationID = ko.observable(data ? data.ResourceAllocationID : "");
        self.CraftID = ko.observable(data ? data.CraftID : "");
        self.CraftName = ko.observable(data ? data.CraftName : "");
        self.ShiftID = ko.observable(data ? data.ShiftID : "");
        self.TugResourceName = ko.observable(data ? data.TugResourceName : "");
        self.SlotPeriod = ko.observable(data ? data.SlotPeriod : "");
        self.IsChanged = ko.observable(data ? data.IsChanged : false);
        self.TaskStatus = ko.observable(data ? data.TaskStatus : "");
        self.AllocationDate = ko.observable(data ? data.AllocationDate : "");
        	//$("#divResourceCount").sortable({
        	//	cancel: ".BLCK"
        	//});

    }

    //Service Type DDL
    var ServiceType = function (data) {
        var self = this;

        self.serviceTypeList = ko.observableArray(data ? $.map(data, function (item1) { return new serviceTypeDetail(item1); }) : []);
    }

    //Service details binding
    var serviceTypeDetail = function (data) {
        var self = this;

        self.SubCatCode = ko.observable(data ? data.SubCatCode : "");
        self.SubCatName = ko.observable(data ? data.SubCatName : "");
    }

    //Shift Type DDL
    var ShiftType = function (data) {
        var self = this;

        self.shiftTypeList = ko.observableArray(data ? $.map(data, function (item1) { return new shiftTypeDetail(item1); }) : []);
    }

    //Shift Type details binding
    var shiftTypeDetail = function (data) {
        var self = this;

        self.ShiftID = ko.observable(data ? data.ShiftID : "");
        self.ShiftName = ko.observable(data ? data.ShiftName : "");
    }

    //$('#MovementModel-modal').on('show', function (data) {
    //    
    //    //var form = $('#Timesheet');
    //    //var timesheet = form.data('timesheet    if (!timesheet)
    //    //    return;
    //});
    // ipmsRoot.ResourceAllocationSlots = ResourceAllocationSlots;

    var ResourceCalendarSearchModel = function (data) {
        var self = this;
        self.ShiftID = ko.observable(data ? data.ShiftID : 0);
        self.OperationType = ko.observable(data ? data.OperationType : "");
        self.AllocationDate = ko.observable(data ? data.AllocationDate : "");
    }

    var ResourceCalendarModel = function (data) {
        var self = this;
        self.UserID = ko.observable(data ? data.UserID : 0);
        self.UserFullName = ko.observable(data ? data.UserFullName : "");
        self.ShiftID = ko.observable(data ? data.ShiftID : 0);
        self.AllocSlot = ko.observableArray(data ? data.AllocSlot : "");
        self.AllocationDate = ko.observable(data ? data.AllocationDate : "");
        self.AttendanceStatus = ko.observable(data ? data.AttendanceStatus : "");
        self.ResourceWorkStatus = ko.observable(data ? data.ResourceWorkStatus : "");
        self.AttendanceDate = ko.observable(data ? data.AttendanceDate : "");
        self.VCN = ko.observable(data ? data.VCN : "");
        self.Designation = ko.observable(data ? data.Designation : "");

        self.ResourceCalendarSlotDetails = ko.observableArray(data ? ko.utils.arrayMap(data.ResourceCalendarSlotDetails, function (item) {
            return new ResourceCalendarSlotDetailed(item);
        }) : []);
    }

    var ResourceCalendarSlotDetailed = function (data) {
        var self = this;
        self.VCN = ko.observable(data ? data.VCN : "");
        self.AttendanceStatus = ko.observable(data ? data.AttendanceStatus : "");
        self.SlotPeriod = ko.observable(data ? data.SlotPeriod : "");
        self.SlotText = ko.observable(data ? data.SlotText : "");
    }

    var ResourceCalendarHeaderModel = function (data) {
        var self = this;
        self.UserID = ko.observable(data ? data.UserID : "");
        self.UserFullName = ko.observable(data ? data.UserFullName : "");
        self.ResourceCalendarSlots = ko.observableArray(data ? ko.utils.arrayMap(data.ResourceCalendarSlots, function (item) {
            return new ResourceCalendarSlot(item);
        }) : []);
    }

    var ResourceCalendarSlot = function (data) {
        var self = this;
        self.SlotNumber = ko.observable(data ? data.SlotNumber : "");
        self.AllocSlot = ko.observable(data ? data.AllocSlot : "");
        self.ResourceDetails = ko.observable(data ? data.ResourceDetails : "");
    }

    ipmsRoot.ResourceAllocations = ResourceAllocations;
    ipmsRoot.ServiceType = ServiceType;
    ipmsRoot.serviceTypeDetail = serviceTypeDetail;
    ipmsRoot.ResourceAllocationSlots = ResourceAllocationSlots;
    ipmsRoot.ResourceSlot = ResourceSlot;
    ipmsRoot.AutomatedResourceScheduleModel = AutomatedResourceScheduleModel;
    ipmsRoot.ConfirmedServiceRequestsModel = ConfirmedServiceRequestsModel;
    ipmsRoot.ResourceSlotVO = ResourceSlotVO;
    ipmsRoot.Slot = Slot;
    ipmsRoot.Users = Users;
    ipmsRoot.shiftTypeDetail = shiftTypeDetail;
    ipmsRoot.ResourceCalendarSearchModel = ResourceCalendarSearchModel;
    ipmsRoot.ResourceCalendarModel = ResourceCalendarModel;
    ipmsRoot.ResourceCalendarHeaderModel = ResourceCalendarHeaderModel;
    ipmsRoot.ResourceCalendarSlot = ResourceCalendarSlot;
    ipmsRoot.ResourceCalendarSlotDetailed = ResourceCalendarSlotDetailed;

}(window.IPMSROOT));