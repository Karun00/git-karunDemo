delete from NotificationRole where NotificationTemplateCode = 'SSEU' 
GO
delete from NotificationPort where NotificationTemplateCode = 'SSEU'
GO
delete from NotificationTemplate where NotificationTemplateCode = 'SSEU'
GO
delete from WorkflowTaskRole where EntityID = (select EntityID from Entity where EntityCode = 'SSRQ') and Step = 20
GO
delete from NotificationRole where NotificationTemplateCode IN ('SSCA',
'SSRA',
'SSRE',
'SSRN',
'SSRU')
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRQ') EntityId, 'WFCA' as WorkflowTaskCode, 30 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, null APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRQ') EntityId, RoleId, 20 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('FC',',')))) A Order By PortCode
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRQ') EntityId, RoleId, 30 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('AGNT',',')))) A Order By PortCode
GO
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SSCA' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SSRA' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SSRE' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SSRN' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SSRU' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
GO

Update NotificationTemplate set EmailTemplate = '<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been rejected.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
where NotificationTemplateCode = 'SSRE'
GO

INSERT INTO ENTITY
(EntityCode, Moduleid, Entityname, PageUrl, OrderNo, Tokens, HasWorkflow, HasMenuItem, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PendingTaskColumns, ControllerName) VALUES
('SSRF', 20, 'Floating Crane Supplementary Service Request', 'SupplementaryServiceRequests', 2, 'VCN,ServiceType,PortCode,QuayCode,BerthCode,FromDate,ToDate,CreatedDate,PortName,VesselName,BerthName,ServiceTypeName,EntityName', 'Y', 'N', 'A', 2, getDate(), 2, getDate(), N'VCN,Service Type Name,Quay Code,Berth Code,From Date,To Date,Created Date', 'SupplementaryService')
GO
INSERT INTO ENTITYPRIVILEGE
(EntityID, SubCatCode, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) VALUES
((select EntityID from Entity where EntityCode = 'SSRF'), 'ADD', 'A', 1, getDate(), 1, getDate()),
((select EntityID from Entity where EntityCode = 'SSRF'), 'EDIT', 'A', 1, getDate(), 1, getDate()),
((select EntityID from Entity where EntityCode = 'SSRF'), 'VIEW', 'A', 1, getDate(), 1, getDate())
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRF') EntityId, 'NEW' as WorkflowTaskCode, 0 Step,20 NextStep,0 ValidityPeriod, 'Y' HasNotification, '' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRF') EntityId, 'UPDT' as WorkflowTaskCode, 0 Step,20 NextStep,0 ValidityPeriod, 'Y' HasNotification, '' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRF') EntityId, 'WFSA' as WorkflowTaskCode, 20 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, 'api/SupplymentaryServiceRequest/ApproveSupplymentaryServiceRequest' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRF') EntityId, 'WFRE' as WorkflowTaskCode, 20 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, 'api/SupplymentaryServiceRequest/RejectSupplymentaryServiceRequest' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'Y' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRF') EntityId, 'CLOS' as WorkflowTaskCode, 9999 Step, null NextStep,0 ValidityPeriod, 'Y' HasNotification, null APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRF') EntityId, 'WFCA' as WorkflowTaskCode, 30 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, null APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRF') EntityId, RoleId, 30 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('AGNT',',')))) A Order By PortCode
GO
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRF') EntityId, RoleId, 0 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('AGNT',',')))) A Order By PortCode
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRF') EntityId, RoleId, 20 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('FLTC',',')))) A Order By PortCode
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRFN','New Supplymentary Service Request', (select EntityId from Entity where EntityCode='SSRF'),'NEW', NULL,'Y','Supplimentary Service Request','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been received by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been received by Port of %PortName%.','Y',' This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been received by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRFU','Supplymentary Service Request Updated', (select EntityId from Entity where EntityCode='SSRF'),'UPDT', NULL,'Y','Supplymentary Service Request Updated','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been updated by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been updated by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been updated by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRFA','Supplymentary Service Request Approved', (select EntityId from Entity where EntityCode='SSRF'),'WFSA', NULL,'Y','Supplymentary Service Request Approved','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been approved by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been approved by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been approved by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRFE','Supplymentary Service Request Rejected', (select EntityId from Entity where EntityCode='SSRF'),'WFRE', NULL,'Y','Supplymentary Service Request Rejected','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been rejected.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been rejected by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been rejected by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRFC','Supplymentary Service Request Cancelled', (select EntityId from Entity where EntityCode='SSRF'),'WFCA', NULL,'Y','Supplymentary Service Request Cancelled','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been cancelled by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been cancelled by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been cancelled by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRFN',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRFU',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRFA',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRFE',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRFC',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
GO

INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRFN' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FLTC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRPA' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FLTC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRFA' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FLTC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRFE' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FLTC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRFC' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FLTC',',')))  A; 
GO
INSERT INTO ENTITY
(EntityCode, Moduleid, Entityname, PageUrl, OrderNo, Tokens, HasWorkflow, HasMenuItem, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PendingTaskColumns, ControllerName) VALUES
('SSRHC', 20, 'Hot and Cold Work Permit Supplementary Service Request', 'SupplementaryServiceRequests', 2, 'VCN,ServiceType,PortCode,QuayCode,BerthCode,FromDate,ToDate,CreatedDate,PortName,VesselName,BerthName,ServiceTypeName,EntityName', 'Y', 'N', 'A', 2, getDate(), 2, getDate(), N'VCN,Service Type Name,Quay Code,Berth Code,From Date,To Date,Created Date', 'SupplementaryService')
GO
INSERT INTO ENTITYPRIVILEGE
(EntityID, SubCatCode, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) VALUES
((select EntityID from Entity where EntityCode = 'SSRHC'), 'ADD', 'A', 1, getDate(), 1, getDate()),
((select EntityID from Entity where EntityCode = 'SSRHC'), 'EDIT', 'A', 1, getDate(), 1, getDate()),
((select EntityID from Entity where EntityCode = 'SSRHC'), 'VIEW', 'A', 1, getDate(), 1, getDate())
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRHC') EntityId, 'NEW' as WorkflowTaskCode, 0 Step,20 NextStep,0 ValidityPeriod, 'Y' HasNotification, '' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRHC') EntityId, 'UPDT' as WorkflowTaskCode, 0 Step,20 NextStep,0 ValidityPeriod, 'Y' HasNotification, '' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRHC') EntityId, 'WFSA' as WorkflowTaskCode, 20 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, 'api/SupplymentaryServiceRequest/ApproveSupplymentaryServiceRequest' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRHC') EntityId, 'WFRE' as WorkflowTaskCode, 20 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, 'api/SupplymentaryServiceRequest/RejectSupplymentaryServiceRequest' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'Y' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRHC') EntityId, 'CLOS' as WorkflowTaskCode, 9999 Step, null NextStep,0 ValidityPeriod, 'Y' HasNotification, null APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRHC') EntityId, 'WFCA' as WorkflowTaskCode, 30 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, null APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRHC') EntityId, RoleId, 30 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('AGNT',',')))) A Order By PortCode
GO
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRHC') EntityId, RoleId, 0 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('AGNT',',')))) A Order By PortCode
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRHC') EntityId, RoleId, 20 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('FC',',')))) A Order By PortCode
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRCN','New Supplymentary Service Request', (select EntityId from Entity where EntityCode='SSRHC'),'NEW', NULL,'Y','Supplimentary Service Request','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been received by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been received by Port of %PortName%.','Y',' This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been received by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRCU','Supplymentary Service Request Updated', (select EntityId from Entity where EntityCode='SSRHC'),'UPDT', NULL,'Y','Supplymentary Service Request Updated','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been updated by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been updated by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been updated by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SHCA','Supplymentary Service Request Approved', (select EntityId from Entity where EntityCode='SSRHC'),'WFSA', NULL,'Y','Supplymentary Service Request Approved','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been approved by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been approved by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been approved by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRCE','Supplymentary Service Request Rejected', (select EntityId from Entity where EntityCode='SSRHC'),'WFRE', NULL,'Y','Supplymentary Service Request Rejected','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been rejected.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been rejected by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been rejected by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SHCC','Supplymentary Service Request Cancelled', (select EntityId from Entity where EntityCode='SSRHC'),'WFCA', NULL,'Y','Supplymentary Service Request Cancelled','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been cancelled by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been cancelled by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been cancelled by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRCN',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRCU',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SHCA',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRCE',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SHCC',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
GO
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRCN' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRCU' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SHCA' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRCE' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SHCC' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
GO
INSERT INTO ENTITY
(EntityCode, Moduleid, Entityname, PageUrl, OrderNo, Tokens, HasWorkflow, HasMenuItem, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PendingTaskColumns, ControllerName) VALUES
('SSRH', 20, 'Hot Work Permit Supplementary Service Request', 'SupplementaryServiceRequests', 2, 'VCN,ServiceType,PortCode,QuayCode,BerthCode,FromDate,ToDate,CreatedDate,PortName,VesselName,BerthName,ServiceTypeName,EntityName', 'Y', 'N', 'A', 2, getDate(), 2, getDate(), N'VCN,Service Type Name,Quay Code,Berth Code,From Date,To Date,Created Date', 'SupplementaryService')
GO
INSERT INTO ENTITYPRIVILEGE
(EntityID, SubCatCode, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) VALUES
((select EntityID from Entity where EntityCode = 'SSRH'), 'ADD', 'A', 1, getDate(), 1, getDate()),
((select EntityID from Entity where EntityCode = 'SSRH'), 'EDIT', 'A', 1, getDate(), 1, getDate()),
((select EntityID from Entity where EntityCode = 'SSRH'),'VIEW', 'A', 1, getDate(), 1, getDate())
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRH') EntityId, 'NEW' as WorkflowTaskCode, 0 Step,20 NextStep,0 ValidityPeriod, 'Y' HasNotification, '' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRH') EntityId, 'UPDT' as WorkflowTaskCode, 0 Step,20 NextStep,0 ValidityPeriod, 'Y' HasNotification, '' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRH') EntityId, 'WFSA' as WorkflowTaskCode, 20 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, 'api/SupplymentaryServiceRequest/ApproveSupplymentaryServiceRequest' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRH') EntityId, 'WFRE' as WorkflowTaskCode, 20 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, 'api/SupplymentaryServiceRequest/RejectSupplymentaryServiceRequest' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'Y' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRH') EntityId, 'CLOS' as WorkflowTaskCode, 9999 Step, null NextStep,0 ValidityPeriod, 'Y' HasNotification, null APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO

INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRH') EntityId, 'WFCA' as WorkflowTaskCode, 30 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, null APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRH') EntityId, RoleId, 30 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('AGNT',',')))) A Order By PortCode
GO
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRH') EntityId, RoleId, 0 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('AGNT',',')))) A Order By PortCode
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRH') EntityId, RoleId, 20 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('FC',',')))) A Order By PortCode
GO

INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRHN','New Supplymentary Service Request', (select EntityId from Entity where EntityCode='SSRH'),'NEW', NULL,'Y','Supplimentary Service Request','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been received by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been received by Port of %PortName%.','Y',' This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been received by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRHU','Supplymentary Service Request Updated', (select EntityId from Entity where EntityCode='SSRH'),'UPDT', NULL,'Y','Supplymentary Service Request Updated','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been updated by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been updated by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been updated by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRHA','Supplymentary Service Request Approved', (select EntityId from Entity where EntityCode='SSRH'),'WFSA', NULL,'Y','Supplymentary Service Request Approved','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been approved by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been approved by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been approved by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRHE','Supplymentary Service Request Rejected', (select EntityId from Entity where EntityCode='SSRH'),'WFRE', NULL,'Y','Supplymentary Service Request Rejected','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been rejected.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been rejected by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been rejected by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRHC','Supplymentary Service Request Cancelled', (select EntityId from Entity where EntityCode='SSRH'),'WFCA', NULL,'Y','Supplymentary Service Request Cancelled','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been cancelled by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been cancelled by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been cancelled by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRHN',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRHU',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRHA',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRHE',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRHC',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
GO
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRHN' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRHU' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRHA' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRHE' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRHC' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,FC',',')))  A; 
GO
INSERT INTO ENTITY
(EntityCode, Moduleid, Entityname, PageUrl, OrderNo, Tokens, HasWorkflow, HasMenuItem, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PendingTaskColumns, ControllerName) VALUES
('SSRW', 20, 'Water Supplementary Service Request', 'SupplementaryServiceRequests', 2, 'VCN,ServiceType,PortCode,QuayCode,BerthCode,FromDate,ToDate,CreatedDate,PortName,VesselName,BerthName,ServiceTypeName,EntityName', 'Y', 'N', 'A', 2, getDate(), 2, getDate(), N'VCN,Service Type Name,Quay Code,Berth Code,From Date,To Date,Created Date', 'SupplementaryService')
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRW') EntityId, 'NEW' as WorkflowTaskCode, 0 Step,20 NextStep,0 ValidityPeriod, 'Y' HasNotification, '' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRW') EntityId, 'UPDT' as WorkflowTaskCode, 0 Step,20 NextStep,0 ValidityPeriod, 'Y' HasNotification, '' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRW') EntityId, 'WFSA' as WorkflowTaskCode, 20 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, 'api/SupplymentaryServiceRequest/ApproveSupplymentaryServiceRequest' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRW') EntityId, 'WFRE' as WorkflowTaskCode, 20 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, 'api/SupplymentaryServiceRequest/RejectSupplymentaryServiceRequest' APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'Y' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRW') EntityId, 'CLOS' as WorkflowTaskCode, 9999 Step, null NextStep,0 ValidityPeriod, 'Y' HasNotification, null APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO WorkflowTask(EntityID, WorkflowTaskCode, Step, NextStep, ValidityPeriod, HasNotification, APIUrl, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PortCode, HasRemarks) 
SELECT (select EntityId from Entity where EntityCode='SSRW') EntityId, 'WFCA' as WorkflowTaskCode, 30 Step, 9999 NextStep,0 ValidityPeriod, 'Y' HasNotification, null APIUrl,'A' as RecordStatus,1 as CreatedBy,getdate() as CreatedDate,1 as ModifiedBy, getdate() as ModifiedDate , PortCode, 'N' HasRemarks from Port order by portcode
GO
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRW') EntityId, RoleId, 30 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('AGNT',',')))) A Order By PortCode
GO
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRW') EntityId, RoleId, 0 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('AGNT',',')))) A Order By PortCode
INSERT INTO dbo.WorkflowTaskRole ( EntityID ,RoleID ,Step ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT (select EntityId from Entity where EntityCode='SSRW') EntityId, RoleId, 20 StepId, PortCode, 'A' RecordStatus, 1 CreatedBy, getdate() CreatedDate, 1 ModifiedBy, getdate() ModifiedDate from Port, ((select roleid from Role where Rolecode in (select value from udf_SplitString('WTM',',')))) A Order By PortCode
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRWN','New Supplymentary Service Request', (select EntityId from Entity where EntityCode='SSRW'),'NEW', NULL,'Y','Supplimentary Service Request','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been received by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been received by Port of %PortName%.','Y',' This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been received by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRWU','Supplymentary Service Request Updated', (select EntityId from Entity where EntityCode='SSRW'),'UPDT', NULL,'Y','Supplymentary Service Request Updated','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been updated by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been updated by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been updated by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRWA','Supplymentary Service Request Approved', (select EntityId from Entity where EntityCode='SSRW'),'WFSA', NULL,'Y','Supplymentary Service Request Approved','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been approved by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been approved by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been approved by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRWE','Supplymentary Service Request Rejected', (select EntityId from Entity where EntityCode='SSRW'),'WFRE', NULL,'Y','Supplymentary Service Request Rejected','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been rejected.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been rejected by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been rejected by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationTemplate(NotificationTemplateCode, NotificationTemplateName, EntityID, WorkflowTaskCode, PortCode, IsEmail, EmailSubject,EmailTemplate, IsSMS, SMSTemplate, IsSysMessage, SysMessageTemplate, NotificationTemplateBase, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
SELECT 'SRWC','Supplymentary Service Request Cancelled', (select EntityId from Entity where EntityCode='SSRW'),'WFCA', NULL,'Y','Supplymentary Service Request Cancelled','<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been cancelled by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>'
,'Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been cancelled by Port of %PortName%.','Y','This is to inform you that %EntityName% VCN with %VCN%,VesselName %VesselName% has been cancelled by Port of %PortName%. Regards,IPMS Admin','R','A',1,getDate(),1,getDate()
GO
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRWN',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRWU',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRWA',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRWE',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
INSERT INTO NotificationPort(NotificationTemplateCode ,PortCode ,RecordStatus ,CreatedBy ,CreatedDate ,ModifiedBy ,ModifiedDate) SELECT 'SRWC',Portcode,'A' as RecordStatus,1 as CreatedBy, getDate() as CreatedDate,1 as ModifiedBy,getDate() as ModifiedDate from Port;
GO
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRWN' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,WTM',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRWU' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,WTM',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRWA' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,WTM',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRWE' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,WTM',',')))  A; 
INSERT INTO NotificationRole(NotificationTemplateCode, RoleID, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) SELECT  'SRWC' as NotificationTemplateCode,Roleid,'A' as RecordStatus,1 as CreatedBy, getDate() as Createddate, 1 as ModifiedBy, getDate() as ModifiedDate from (select RoleID from Role where Rolecode in (select value from udf_SplitString('AGNT,WTM',',')))  A; 
GO

ALTER PROCEDURE [dbo].[usp_SuppServRequestCancel]
@p_VCN nvarchar(12),
@p_SuppServiceRequestID int,
@p_Remarks nvarchar(MAX),
@p_UserId int
AS 
BEGIN
declare @usertypeid int,
@usertype varchar(15),
@vcnresult int
BEGIN

select @p_Remarks = coalesce(@p_Remarks,'Supplementary Service Request(s) are Cancelled due to Change ETA')

BEGIN
  select @usertype=u.UserType,@usertypeid=U.UserTypeID from Users U where UserID = @p_UserId
END
IF(@p_VCN != '')
BEGIN

select @vcnresult = count(ssr.SuppServiceRequestID) from suppservicerequest ssr inner join resourceallocation  RC
on ssr.SuppServiceRequestID = rc.ServiceReferenceID where ssr.VCN = @p_VCN and RC.ServiceReferenceType='SUPP'
and rc.TaskStatus not in ('VERF,COMP')

IF(@vcnresult > 0)
BEGIN

insert into WorkflowProcess( WorkflowInstanceId, RoleId, FromTaskCode, ToTaskCode, ReferenceData, Remarks, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
select  a.WorkflowInstanceId, a.RoleId, a.FromTaskCode, 'WFCA' ToTaskCode, a.ReferenceData, @p_Remarks Remarks, a.RecordStatus, a.CreatedBy, a.CreatedDate, a.ModifiedBy, a.ModifiedDate
from WorkflowProcess a,
(select WorkflowInstanceId from WorkflowInstance where entityid in(select dbo.Entity.EntityID from Entity where dbo.Entity.EntityCode IN ('SSRQ','SSRF','SSRH','SSRHC','SSRW'))
and ReferenceID in(select ssr.SuppServiceRequestID from suppservicerequest ssr inner join resourceallocation  RC on ssr.SuppServiceRequestID = rc.ServiceReferenceID where ssr.VCN=@p_VCN and RC.ServiceReferenceType='SUPP' and rc.TaskStatus not in ('VERF,COMP'))) b
where a.WorkflowInstanceId = b.WorkflowInstanceId 
and  a.WorkflowProcessId = (select max(WorkflowProcessId) from WorkflowProcess where WorkflowInstanceId = b.WorkflowInstanceId)

update WorkflowInstance set WorkflowTaskCode = 'WFCA',UserType=@usertype,UserTypeId=@usertypeid where WorkflowInstanceId in(
select WorkflowInstanceId from WorkflowInstance where entityid in(select dbo.Entity.EntityID from Entity where dbo.Entity.EntityCode IN ('SSRQ','SSRF','SSRH','SSRHC','SSRW'))
and ReferenceID in(select ssr.SuppServiceRequestID from suppservicerequest ssr inner join resourceallocation  RC
on ssr.SuppServiceRequestID = rc.ServiceReferenceID where ssr.VCN = @p_VCN and RC.ServiceReferenceType='SUPP'
  and rc.TaskStatus not in ('VERF,COMP')) 
)

update SuppServiceRequest set RecordStatus = 'I', Remarks=Remarks +' ' + @p_Remarks where VCN = @p_VCN
END
END
ELSE
BEGIN
insert into WorkflowProcess( WorkflowInstanceId, RoleId, FromTaskCode, ToTaskCode, ReferenceData, Remarks, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate)
select  a.WorkflowInstanceId, a.RoleId, a.FromTaskCode, 'WFCA' ToTaskCode, a.ReferenceData, @p_Remarks Remarks, a.RecordStatus, a.CreatedBy, a.CreatedDate, a.ModifiedBy, a.ModifiedDate
from WorkflowProcess a,
(select WorkflowInstanceId from WorkflowInstance where entityid in(select dbo.Entity.EntityID from Entity where dbo.Entity.EntityCode IN ('SSRQ','SSRF','SSRH','SSRHC','SSRW'))
and ReferenceID = @p_SuppServiceRequestID) b
where a.WorkflowInstanceId = b.WorkflowInstanceId 
and  a.WorkflowProcessId = (select max(WorkflowProcessId) from WorkflowProcess where WorkflowInstanceId = b.WorkflowInstanceId)

update WorkflowInstance set WorkflowTaskCode = 'WFCA',UserType = @usertype,UserTypeId = @usertypeid where WorkflowInstanceId in(
select WorkflowInstanceId from WorkflowInstance where entityid in(select dbo.Entity.EntityID from Entity where dbo.Entity.EntityCode IN ('SSRQ','SSRF','SSRH','SSRHC','SSRW'))
and ReferenceID = @p_SuppServiceRequestID
)

update SuppServiceRequest set RecordStatus = 'I', Remarks=Remarks +' ' + @p_Remarks where SuppServiceRequestID = @p_SuppServiceRequestID
update ResourceAllocation set ResourceID = null, RecordStatus = 'I' where ServiceReferenceID = @p_SuppServiceRequestID and ServiceReferenceType = 'SUPP'
END
END

END;
GO




Update Entity set Tokens = 'VCN,ServiceType,PortCode,QuayCode,BerthCode,FromDate,ToDate,CreatedDate,PortName,VesselName,BerthName,ServiceTypeName,EntityName,SubmittedDateTime,Remarks',
PendingTaskColumns = 'VCN,Service Type Name,Quay Code,Berth Code,From Date,To Date,Submitted DateTime'
where EntityCode IN ('SSRQ','SSRF','SSRH','SSRHC','SSRW')

GO

Update NotificationTemplate set EmailTemplate = '<p style="margin-bottom: 12pt;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Greetings &nbsp;[UserName],</span></p><p style="margin-bottom: 12pt;"></p><br/><meta charset="utf-8"/><title>Integrated Port Management System</title><table align="center" border="0" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td width="328" height="71" valign="bottom" bgcolor="#dddddd"><table width="548" border="0" align="center" cellpadding="0" cellspacing="0"><tbody><tr><td valign="bottom"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td height="39" colspan="2" bgcolor="#FFFFFF">&nbsp;</td></tr><tr style="background-color: #1d1d1d;"><td height="30"  style="font-family: Verdana;font-size: 14px;font-family: Open Sans, sans-serif;color: #fff; padding-left:2px;">Integrated Port Management System</td><td  style="font-family: Verdana;font-size: 12px;color: #f03225;text-align: right;font-weight: bold;"></td></tr></table></td><td width="17" height="69" valign="bottom" bgcolor="#dddddd"><img height="69" src="https://ipms.transnet.net/Content/Images/email-logo.jpg" width="114"/></td></tr></tbody></table></td></tr><tr><td style="font-family: Verdana;font-size: 12px;background-color: #aacdb3;padding: 25px;"><span style="font-size: 9.0pt;font-family: Verdana,sans-serif;">This is to inform you that your Supplementary Service Request with the below details has been cancelled by Port of %PortName%.</span><br/><br/><table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 12px;background-color: #c9ead1;border: 2px solid #88a790;padding: 6px 4px;color: #3d5343;" width="100%"><tbody><tr><td><span style="font-size: 18px;color: #3d5343;padding-bottom: 5px;display: block;">Supplementary Service Request Details</span><table border="0" cellpadding="5" cellspacing="1" style="font-family: Verdana;font-size: 12px;" width="100%"><tbody><tr style="background-color: #aacdb3;"><td width="38%">VCN</td><td width="62%">%VCN%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Vessel Name</td><td width="62%">%VesselName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Port Name</td><td width="62%">%PortName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Berth</td><td width="62%">%BerthName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Service Type</td><td width="62%">%ServiceTypeName%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Requested Date</td><td width="62%">%CreatedDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request From</td><td width="62%">%FromDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Request To</td><td width="62%">%ToDate%</td></tr><tr style="background-color: #aacdb3;"><td width="38%">Remarks</td><td width="62%">%Remarks%</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><p><img height="15" src="https://ipms.transnet.net/Content/Images/bottom-bar.jpg" width="550"/></p></td></tr></tbody></table><br/><table width="550" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 11px;"><tr><td height="30" colspan="2"style="font-size: 9.0pt;font-family: Verdana,sans-serif;">Kind Regards</td></tr><tr><td width="140" valign="top"><img src="https://ipms.transnet.net/Content/Images/transet-logo-email-sign.png" width="128" height="119" /></td><td width="410"><p><strong>IPMS ADMIN </strong><br /></p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana;font-size: 10px;"><tr><td width="23"><img width="23" height="16" src="https://ipms.transnet.net/Content/Images/email-temp-phone-icon.jpg"/></td><td height="25">(+27 86) 010 9330</td></tr><tr><td>&nbsp;</td><td height="25"><a href="http://www.transnet.net">www.transnet.net</a></td></tr></table><p>&nbsp;</p></td></tr></table>' where NotificationTemplateCode IN 
('SRFC',
'SRHC',
'SHCC',
'SSCA',
'SRWC')
GO
Update NotificationTemplate set EmailSubject = replace(EmailSubject, 'Supplymentary', 'Supplementary')
where EntityID IN (select EntityID from Entity where EntityCode IN ('SSRQ','SSRF','SSRH','SSRHC','SSRW'))
GO
Update NotificationTemplate set EmailSubject = replace(EmailSubject, 'Supplimentary', 'Supplementary')
where EntityID IN (select EntityID from Entity where EntityCode IN ('SSRQ','SSRF','SSRH','SSRHC','SSRW'))
GO
Update NotificationTemplate set NotificationTemplateName = replace(NotificationTemplateName, 'Supplymentary', 'Supplementary')
where EntityID IN (select EntityID from Entity where EntityCode IN ('SSRQ','SSRF','SSRH','SSRHC','SSRW'))
GO
Update NotificationTemplate set NotificationTemplateName = replace(NotificationTemplateName, 'Supplimentary', 'Supplementary')
where EntityID IN (select EntityID from Entity where EntityCode IN ('SSRQ','SSRF','SSRH','SSRHC','SSRW'))
GO


INSERT INTO ENTITY
(EntityCode, Moduleid, Entityname, PageUrl, OrderNo, Tokens, HasWorkflow, HasMenuItem, RecordStatus, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, PendingTaskColumns, ControllerName) VALUES
('SSRC', 20, 'Cold Work Supplementary Service Request', 'SupplementaryServiceRequests', 2, 'VCN,ServiceType,PortCode,QuayCode,BerthCode,FromDate,ToDate,CreatedDate,PortName,VesselName,BerthName,ServiceTypeName,EntityName', 'Y', 'N', 'A', 2, getDate(), 2, getDate(), N'VCN,Service Type Name,Quay Code,Berth Code,From Date,To Date,Created Date', 'SupplementaryService')
GO

Update WorkflowTask set EntityID = (select EntityID from Entity where EntityCode = 'SSRC')
where EntityID = (select EntityID from Entity where EntityCode = 'SSRQ')
GO
Update WorkFlowTaskRole set EntityID = (select EntityID from Entity where EntityCode = 'SSRC')
where EntityID = (select EntityID from Entity where EntityCode = 'SSRQ')
GO
Update NotificationTemplate set EntityID = (select EntityID from Entity where EntityCode = 'SSRC')
where EntityID = (select EntityID from Entity where EntityCode = 'SSRQ')
GO
ALTER PROCEDURE [dbo].[usp_GetServiceRecordingResourceSearch]
   @p_SearchText NVARCHAR(200),
   @p_PortCode NVARCHAR(4)
AS
    BEGIN   
	select FirstName from
	(select  distinct top 200  CONCAT(u.FirstName, ' ', u.LastName) as FirstName  from  dbo.Users u , userport up
              where u.userid in (select distinct ResourceID from ResourceAllocation a where  
              ( a.TaskStatus = 'ACCP' or a.TaskStatus = 'COMP' or a.TaskStatus = 'VERF' 
              or a.TaskStatus='STRD' or a.TaskStatus = 'CFRI' )) and  u.UserID=up.UserID 
			  and up.PortCode = @p_PortCode 
			    ) t where UPPER(FirstName)  Like '%'+UPPER(@p_SearchText)+'%'
			 -- or UPPER(u.LastName)  Like '%'+UPPER(@p_SearchText)+'%' )
             -- order by upper(FirstName)  + ' - ' + u.LastName 
	 
    
    
    END
GO


ALTER PROCEDURE [dbo].[usp_GetServiceRecordinDetails_New]
@portcode nvarchar(2),
@VCN nvarchar(12),
@VesselName nvarchar(20),
@ResourceName  nvarchar(20)
WITH EXEC AS CALLER
AS
begin
        if( RTRIM(LTRIM(UPPER(@VCN))) = 'NA' and RTRIM(LTRIM(UPPER(@ResourceName))) = 'NA' and RTRIM(LTRIM(UPPER(@VesselName))) = 'NA')
        BEGIN
              select ResourceAllocationID,
              ServiceReferenceType , ServiceReferenceTypeName ,
              VCN, VesselName,VesselLength, MovementType, MovementTypeName,
              ServiceReferenceID ,
              OperationType , OperationTypeName ,ResourceID
              ,ResourceType ,
              StartTime ,
              EndTime, FirstName 
              ,TaskStatus , TaskStatusName ,RecordStatus, ModifiedDate,BerthKey
              from (

              select a.ResourceAllocationID,
              a.ServiceReferenceType , c.SubCatName ServiceReferenceTypeName ,
              CASE a.ServiceReferenceType
              WHEN 'SUPP' THEN 
              (select VCN from dbo.SuppServiceRequest where SuppServiceRequestID = a.ServiceReferenceID and PortCode = @portcode) 
              ELSE 
              (select sr.VCN from dbo.ServiceRequest sr
              inner join ArrivalNotification An on An.VCN = sr.VCN 
              where sr.ServiceRequestID = a.ServiceReferenceID
              and An.PortCode = @portcode)
              END VCN,
              CASE a.ServiceReferenceType
              WHEN 'SUPP' THEN 
              (select V.VesselName from dbo.SuppServiceRequest SSR
              inner join ArrivalNotification AN on an.VCN = SSR.VCN
              inner join Vessel V on V.VesselID = AN.VesselID
               where SuppServiceRequestID = a.ServiceReferenceID and AN.PortCode = @portcode) 
              ELSE 
              (select V.VesselName from dbo.ServiceRequest sr
              inner join ArrivalNotification An on An.VCN = sr.VCN 
              inner join Vessel V on v.VesselID = an.VesselID
              where sr.ServiceRequestID = a.ServiceReferenceID
              and An.PortCode = @portcode)
              END VesselName,
              CASE a.ServiceReferenceType
              WHEN 'SUPP' THEN 
              (select V.LengthOverallInM from dbo.SuppServiceRequest SSR
              inner join ArrivalNotification AN on an.VCN = SSR.VCN
              inner join Vessel V on V.VesselID = AN.VesselID
               where SuppServiceRequestID = a.ServiceReferenceID and AN.PortCode = @portcode) 
              ELSE 
              (select V.LengthOverallInM from dbo.ServiceRequest sr
              inner join ArrivalNotification An on An.VCN = sr.VCN 
              inner join Vessel V on v.VesselID = an.VesselID
              where sr.ServiceRequestID = a.ServiceReferenceID
              and An.PortCode = @portcode)
              END VesselLength,
              CASE a.ServiceReferenceType
              WHEN 'SUPP' THEN 
              (select Servicetype from dbo.SuppServiceRequest where SuppServiceRequestID = a.ServiceReferenceID and PortCode = @portcode) 
              ELSE 
              (select MovementType from dbo.ServiceRequest sr
              inner join ArrivalNotification An on An.VCN = sr.VCN 
              where sr.ServiceRequestID = a.ServiceReferenceID
              and An.PortCode = @portcode)
              END MovementType,
              CASE a.ServiceReferenceType
              WHEN 'SUPP' THEN 
              (select sc.SubCatName from dbo.SuppServiceRequest ssr
              join SubCategory sc on sc.SubCatCode = ssr.ServiceType where ssr.SuppServiceRequestID = a.ServiceReferenceID and ssr.PortCode = @portcode) 
              ELSE 
              (select sc.SubCatName from dbo.ServiceRequest sr
              inner join ArrivalNotification An on An.VCN = sr.VCN 
              inner join SubCategory sc on sc.SubCatCode = sr.MovementType
              where sr.ServiceRequestID = a.ServiceReferenceID
              and An.PortCode = @portcode)
              END MovementTypeName,
              a.ServiceReferenceID ,
              a.OperationType , b.ServiceTypeName OperationTypeName ,
              a.ResourceID
              ,a.ResourceType ,
              a.StartTime as StartTime ,
              a.EndTime as EndTime,CONCAT(u.FirstName, ' ', u.LastName) AS FirstName 
              ,a.TaskStatus , e.SubCatName TaskStatusName ,a.RecordStatus, a.ModifiedDate,
              CASE a.ServiceReferenceType
              WHEN 'SUPP' THEN 
                  ( select CONCAT(b.PortCode,'.',b.QuayCode,'.',b.BerthCode) AS BerthKey from SuppServiceRequest s
                       left JOIN Berth b on s.PortCode = b.PortCode AND s.QuayCode = b.QuayCode AND s.BerthCode = b.BerthCode
                       where s.SuppServiceRequestID = a.ServiceReferenceID  )
              ELSE 
               ' '
              END BerthKey
              from dbo.ResourceAllocation a 
              inner join dbo.ServiceType b ON b.ServiceTypeCode = a.OperationType
              inner join dbo.SubCategory c ON c.SubCatCode = a.ServiceReferenceType 
              inner join dbo.SubCategory e ON e.SubCatCode = a.TaskStatus 
              Left join dbo.Users u ON a.ResourceID = u.UserID
              where
              AllocationDate > getdate()-15 and
			   (
              a.TaskStatus = 'ACCP' or a.TaskStatus = 'COMP' or a.TaskStatus = 'VERF' 
              or a.TaskStatus='STRD' or a.TaskStatus = 'CFRI' )


              ) t where t.VCN is not null
              order by ModifiedDate desc
        END
        else
        BEGIN
        
        if(@VCN  = 'NA')
          select @VCN = '';
          
        if(@VesselName  = 'NA')
          select @VesselName = '';
          
        if(@ResourceName  = 'NA')
          select @ResourceName = '';
         

        select ResourceAllocationID,
              ServiceReferenceType , ServiceReferenceTypeName ,
              VCN, VesselName,VesselLength, MovementType, MovementTypeName,
              ServiceReferenceID ,
              OperationType , OperationTypeName ,ResourceID
              ,ResourceType ,
              StartTime ,
              EndTime, FirstName 
              ,TaskStatus , TaskStatusName ,RecordStatus, ModifiedDate,BerthKey
              from (

              select a.ResourceAllocationID,
              a.ServiceReferenceType , c.SubCatName ServiceReferenceTypeName ,
              CASE a.ServiceReferenceType
              WHEN 'SUPP' THEN 
              (select VCN from dbo.SuppServiceRequest where SuppServiceRequestID = a.ServiceReferenceID and PortCode = @portcode) 
              ELSE 
              (select sr.VCN from dbo.ServiceRequest sr
              inner join ArrivalNotification An on An.VCN = sr.VCN 
              where sr.ServiceRequestID = a.ServiceReferenceID
              and An.PortCode = @portcode)
              END VCN,
              CASE a.ServiceReferenceType
              WHEN 'SUPP' THEN 
              (select V.VesselName from dbo.SuppServiceRequest SSR
              inner join ArrivalNotification AN on an.VCN = SSR.VCN
              inner join Vessel V on V.VesselID = AN.VesselID
               where SuppServiceRequestID = a.ServiceReferenceID and AN.PortCode = @portcode) 
              ELSE 
              (select V.VesselName from dbo.ServiceRequest sr
              inner join ArrivalNotification An on An.VCN = sr.VCN 
              inner join Vessel V on v.VesselID = an.VesselID
              where sr.ServiceRequestID = a.ServiceReferenceID
              and An.PortCode = @portcode)
              END VesselName,
              CASE a.ServiceReferenceType
              WHEN 'SUPP' THEN 
              (select V.LengthOverallInM from dbo.SuppServiceRequest SSR
              inner join ArrivalNotification AN on an.VCN = SSR.VCN
              inner join Vessel V on V.VesselID = AN.VesselID
               where SuppServiceRequestID = a.ServiceReferenceID and AN.PortCode = @portcode) 
              ELSE 
              (select V.LengthOverallInM from dbo.ServiceRequest sr
              inner join ArrivalNotification An on An.VCN = sr.VCN 
              inner join Vessel V on v.VesselID = an.VesselID
              where sr.ServiceRequestID = a.ServiceReferenceID
              and An.PortCode = @portcode)
              END VesselLength,
              CASE a.ServiceReferenceType
              WHEN 'SUPP' THEN 
              (select Servicetype from dbo.SuppServiceRequest where SuppServiceRequestID = a.ServiceReferenceID and PortCode = @portcode) 
              ELSE 
              (select MovementType from dbo.ServiceRequest sr
              inner join ArrivalNotification An on An.VCN = sr.VCN 
              where sr.ServiceRequestID = a.ServiceReferenceID
              and An.PortCode = @portcode)
              END MovementType,
              CASE a.ServiceReferenceType
              WHEN 'SUPP' THEN 
              (select sc.SubCatName from dbo.SuppServiceRequest ssr
              join SubCategory sc on sc.SubCatCode = ssr.ServiceType where ssr.SuppServiceRequestID = a.ServiceReferenceID and ssr.PortCode = @portcode) 
              ELSE 
              (select sc.SubCatName from dbo.ServiceRequest sr
              inner join ArrivalNotification An on An.VCN = sr.VCN 
              inner join SubCategory sc on sc.SubCatCode = sr.MovementType
              where sr.ServiceRequestID = a.ServiceReferenceID
              and An.PortCode = @portcode)
              END MovementTypeName,
              a.ServiceReferenceID ,
              a.OperationType , b.ServiceTypeName OperationTypeName ,
              a.ResourceID
              ,a.ResourceType ,
              a.StartTime as StartTime ,
              a.EndTime as EndTime,CONCAT(u.FirstName, ' ', u.LastName) AS FirstName 
              ,a.TaskStatus , e.SubCatName TaskStatusName ,a.RecordStatus, a.ModifiedDate,
              CASE a.ServiceReferenceType
              WHEN 'SUPP' THEN 
                  ( select CONCAT(b.PortCode,'.',b.QuayCode,'.',b.BerthCode) AS BerthKey from SuppServiceRequest s
                       left JOIN Berth b on s.PortCode = b.PortCode AND s.QuayCode = b.QuayCode AND s.BerthCode = b.BerthCode
                       where s.SuppServiceRequestID = a.ServiceReferenceID  )
              ELSE 
               ' '
              END BerthKey
              from dbo.ResourceAllocation a 
              inner join dbo.ServiceType b ON b.ServiceTypeCode = a.OperationType
              inner join dbo.SubCategory c ON c.SubCatCode = a.ServiceReferenceType 
              inner join dbo.SubCategory e ON e.SubCatCode = a.TaskStatus 
              Left join dbo.Users u ON a.ResourceID = u.UserID
              where
               (
              a.TaskStatus = 'ACCP' or a.TaskStatus = 'COMP' or a.TaskStatus = 'VERF' 
              or a.TaskStatus='STRD' or a.TaskStatus = 'CFRI' )

              ) t where t.VCN is not null
              and t.VCN  like '%'+ upper(coalesce (@VCN, t.VCN))+ '%' 
              and t.VesselName  like '%'+ upper(coalesce (@VesselName, t.VesselName))+ '%' 
              and t.FirstName  like '%'+ upper(coalesce (@ResourceName, t.FirstName))+ '%' 
			  -- and (upper(t.VCN)  like '%'+ upper(@VCN)+ '%' 
              --or upper(t.VesselName)  like '%'+ upper(@VesselName)+ '%' 
              --or upper(t.FirstName)  like '%'+ upper(@ResourceName)+ '%' )
              order by ModifiedDate desc
              
        END
end
GO
